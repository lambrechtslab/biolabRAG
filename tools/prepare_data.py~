

if os.path.isdir(persist_directory):
    print("Found RAG library. Loading")
    self.vector_store = Chroma(
        collection_name="example_collection",
        embedding_function=self.embeddings,
        persist_directory=persist_directory,  # Where to save data locally, remove if not necessary
    )
else:
    print(f"Prepare RAG library to folder: {persist_directory}")
    self.vector_store = Chroma(
        collection_name="example_collection",
        embedding_function=self.embeddings,
        persist_directory=persist_directory,  # Where to save data locally, remove if not necessary
    )
    text_splitter = RecursiveCharacterTextSplitter(chunk_size=500, chunk_overlap=50)
    for filename in os.listdir(pdf_folder):
        if filename.endswith(".pdf"):
            print(f"Loading {filename} ...", end='')
            loader = PyPDFLoader(os.path.join(pdf_folder, filename))
            docs = loader.load()
            print(f"Splitting...", end='')
            chunk = text_splitter.split_documents(docs)
            print(f"Embedding & saving...", end='')
            self.vector_store.add_documents(chunk)
            print("Done.")
    
